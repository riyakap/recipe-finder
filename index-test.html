<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Find perfect recipes based on ingredients you have. Simple, fast, and delicious meal ideas.">
    <meta name="keywords" content="recipes, cooking, ingredients, meal planning, food">
    <title>Recipe Finder - Cook with What You Have</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="preload" href="js/app.js" as="script">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üç≥</text></svg>">
    
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .loading-overlay { 
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background: rgba(0,0,0,0.8); color: white; 
            display: flex; align-items: center; justify-content: center;
            font-size: 18px; z-index: 9999;
        }
        .alert { 
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            padding: 15px 20px; border-radius: 8px; font-weight: bold; z-index: 10000;
        }
        .alert.error { background: #f44336; color: white; }
        .alert.success { background: #4caf50; color: white; }
    </style>
</head>
<body>
    <h1>üîç Index Test - Auto-Search Bug</h1>
    <p>This is the main index.html but with minimal structure to test the auto-search bug.</p>
    
    <div>
        <input type="text" id="ingredient-input" placeholder="Type ingredients">
        <div id="suggestions-dropdown" style="display: none;"></div>
        <div id="ingredient-tags"></div>
        
        <select id="cooking-time">
            <option value="">Any time</option>
            <option value="30">30 min</option>
        </select>
        
        <select id="servings">
            <option value="4" selected>4 people</option>
        </select>
        
        <select id="diet">
            <option value="">Any diet</option>
            <option value="vegetarian">Vegetarian</option>
        </select>
        
        <button id="search-btn" disabled>Find Recipes</button>
    </div>
    
    <div id="results-section" style="display: none;">
        <div id="results-header"></div>
        <div id="results-grid"></div>
    </div>
    
    <div id="no-results" style="display: none;">No results</div>
    <div id="error-state" style="display: none;">
        <p id="error-message">Error</p>
    </div>
    
    <!-- This is what we're monitoring -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div>Searching for delicious recipes...</div>
    </div>
    
    <div id="recipe-modal" style="display: none;">
        <div id="modal-body"></div>
    </div>
    
    <div id="toast-container"></div>

    <script>
        console.log('üß™ Starting index test...');
        
        // Monitor loading overlay
        let autoSearchDetected = false;
        const loadingOverlay = document.getElementById('loading-overlay');
        
        function showAlert(message, type) {
            const alert = document.createElement('div');
            alert.className = `alert ${type}`;
            alert.textContent = message;
            document.body.appendChild(alert);
            setTimeout(() => alert.remove(), 5000);
        }
        
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    const isVisible = loadingOverlay.style.display !== 'none';
                    if (isVisible && !autoSearchDetected) {
                        autoSearchDetected = true;
                        console.error('‚ùå AUTO-SEARCH DETECTED IN INDEX TEST!');
                        showAlert('‚ùå AUTO-SEARCH BUG DETECTED IN INDEX TEST!', 'error');
                        document.body.style.backgroundColor = '#ffebee';
                    }
                }
            });
        });
        observer.observe(loadingOverlay, { attributes: true });
        
        // Check after 3 seconds
        setTimeout(() => {
            if (!autoSearchDetected) {
                console.log('‚úÖ No auto-search detected in index test');
                showAlert('‚úÖ No auto-search in index test', 'success');
                document.body.style.backgroundColor = '#e8f5e8';
            }
        }, 3000);
    </script>

    <!-- Load scripts exactly like the main index.html -->
    <script src="js/utils/constants.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/services/CacheManager.js"></script>
    <script src="js/services/RecipeAPI.js"></script>
    <script src="js/components/IngredientInput.js"></script>
    <script src="js/components/FilterManager.js"></script>
    <script src="js/components/RecipeCard.js"></script>
    <script src="js/components/RecipeModal.js"></script>
    <script src="js/app.js"></script>
    
    <!-- NO SERVICE WORKER -->
    <script>
        console.log('No service worker in this test');
    </script>
</body>
</html>